name: eclipse
base: core18

version: '2020-12'
summary: Extensible Tool Platform and Java IDE
description:
  Eclipse provides IDEs and platforms for nearly every language and architecture.
  We are famous for our Java IDE, C/C++, JavaScript and PHP IDEs built on extensible
  platforms for creating desktop, Web and cloud IDEs. These platforms deliver the most
  extensive collection of add-on tools available for software developers.

grade: stable
confinement: classic

architectures:
  - build-on: amd64

apps:
  eclipse:
    command: eclipse -configuration ${SNAP_USER_DATA}/${SNAP_ARCH}/configuration

parts:
  eclipse:
    plugin: dump
    source: http://ftp.halifax.rwth-aachen.de/eclipse/technology/epp/downloads/release/$SNAPCRAFT_PROJECT_VERSION/R/eclipse-java-$SNAPCRAFT_PROJECT_VERSION-R-linux-gtk-x86_64.tar.gz
    source-checksum: "sha512/1d5aac59454d35175c6b388674d23de91f45d953141389d82b5557d46de92beb2b14396427bfab8f6b198ed58bed67094755d26d3d379c92733f2a74d51b02bd"
    override-build: |
      snapcraftctl build
      # Add these missing libraries to DT_NEEDED
      patchelf \
        --add-needed libffi.so.6 \
        --add-needed libgdk_pixbuf-2.0.so.0 \
        --add-needed libgio-2.0.so.0 \
        --add-needed libglib-2.0.so.0 \
        --add-needed libgmodule-2.0.so.0 \
        --add-needed libgobject-2.0.so.0 \
        --add-needed libsecret-1.so.0 \
        eclipse
    build-packages:
      - patchelf
    stage-packages:
      - libffi6
      - libgdk-pixbuf2.0-0
      - libglib2.0-0
      - libsecret-1-0
